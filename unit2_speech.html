
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>UNIT2 èªéŸ³è¾¨è­˜</title>
  <style>
    body { font-family: Arial; padding: 20px; text-align: center; }
    .question { font-size: 1.5em; margin: 20px 0; }
    .result { font-weight: bold; margin-top: 10px; }
    .hidden { display: none; }
    button { font-size: 1.2em; padding: 10px 20px; margin: 10px; }
  </style>
</head>
<body>
  <h1>UNIT2 èªéŸ³è¾¨è­˜ç·´ç¿’</h1>
  <div id="score">ç›®å‰å¾—åˆ†ï¼š0 åˆ†</div>
  <div id="questionArea" class="question"></div>
  <button onclick="startRecognition()">ğŸ¤ é–‹å§‹èªªè©±</button>
  <button onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
  <div class="result" id="resultArea"></div>

  <script>
    const questions = [
      "What's your name?",
      "I'm Kevin.",
      "Nice to meet you.",
      "My name is Mia.",
      "Hello, Kevin.",
      "Good morning."
    ];

    let current = 0;
    let score = 0;
    let wrongQuestions = [];

    function showQuestion(index) {
      document.getElementById("questionArea").innerText = questions[index];
    }

    function nextQuestion() {
      if (current < questions.length - 1) {
        current++;
        showQuestion(current);
        document.getElementById("resultArea").innerText = '';
      } else if (wrongQuestions.length > 0) {
        questions.splice(0, questions.length, ...wrongQuestions);
        wrongQuestions = [];
        current = 0;
        alert("é‡åšéŒ¯çš„é¡Œç›®ï¼");
        showQuestion(current);
        document.getElementById("resultArea").innerText = '';
      } else {
        if (score >= 60) {
          document.body.innerHTML = "<h2>ğŸ‰ æ­å–œä½ å®Œæˆ UNIT2ï¼</h2><a href='unit3.html'>ğŸ‘‰ é€²å…¥ UNIT3</a>";
        } else {
          alert("è«‹é‡æ–°æŒ‘æˆ°ï¼Œåˆ†æ•¸æœªé”æ¨™ï¼");
          location.reload();
        }
      }
    }

    function startRecognition() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = "en-US";
      recognition.start();

      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        const expected = questions[current];
        const similarity = compare(transcript, expected);

        if (similarity >= 0.8) {
          document.getElementById("resultArea").innerText = "âœ… æ­£ç¢ºï¼š" + transcript;
          score += 10;
          document.getElementById("score").innerText = "ç›®å‰å¾—åˆ†ï¼š" + score + " åˆ†";
        } else {
          document.getElementById("resultArea").innerText = "âŒ éŒ¯èª¤ï¼š" + transcript;
          wrongQuestions.push(expected);
        }
      };
    }

    function compare(str1, str2) {
      str1 = str1.toLowerCase();
      str2 = str2.toLowerCase();
      const words1 = str1.split(" ");
      const words2 = str2.split(" ");
      const matchCount = words1.filter(word => words2.includes(word)).length;
      return matchCount / words2.length;
    }

    // åˆå§‹åŒ–
    showQuestion(current);
  </script>
</body>
</html>
